// ################################################################ 
//  This file has been generated by the hashspace compiler          
//  Direct MODIFICATIONS WILL BE LOST when the file is recompiled!  
// ################################################################ 

var hsp=require("hsp/rt");

/*
 * Copyright 2012 Amadeus s.a.s.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *    http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */


/**
 * Main template
 * @param ds the data set
 * @parm ctl the controller to containing the event handler callbacks
 */

var todos =exports.todos = require("hsp/rt").template(["ds","ctl"], function(n){
  var _todoItem,_filterLink;try {_todoItem=todoItem} catch(e) {};try {_filterLink=filterLink} catch(e) {};
  return [n.elt("section",0,{"id":"todoapp"},{"selectstart":"return false;"},[n.elt("header",0,{"id":"header"},0,[n.elt("h1",0,0,0,[n.$text(0,["todos"])]),n.elt("form",{e1:[3,2,"ctl","addTodo"]},{"id":"todo-form"},{"submit":1},[n.$text(0,[" "]),n.elt("input",{e1:[1,3,"ds","newTodo","title"]},{"id":"new-todo","autocomplete":"off","autofocus":null,"placeholder":"What needs to be done?","value":["",1]},0)])]),n.$if({e1:[1,3,"ds","todos","length"]},1,[n.elt("section",0,{"id":"main"},0,[n.$text(0,[" "]),n.elt("input",{e1:[1,2,"ds","allChecked"],e2:[3,2,"ctl","toggleAllDone"]},{"id":"toggle-all","type":"checkbox","value":["",1],"title":"Mark all done"},{"change":2}),n.elt("label",0,{"for":"toggle-all"},0,[n.$text(0,["Mark all as complete"])]),n.elt("ul",0,{"id":"todo-list"},0,[n.$foreach({e1:[1,2,"ds","todos"]},"todo_key","todo",0,1,[n.$if({e1:[3,2,"ctl","isInFilter",1,2,1,3],e2:[1,1,"todo"],e3:[1,2,"ds","filter"]},1,[n.cpt([_todoItem,"todoItem"],{e1:[1,1,"todo"],e2:[1,1,"ds"],e3:[1,1,"ctl"]},{"todo":["",1],"ds":["",2],"ctl":["",3]},0)])]),n.$text(0,[" "])])]),n.elt("footer",0,{"id":"footer"},0,[n.elt("span",0,{"id":"todo-count"},0,[n.elt("strong",0,0,0,[n.$text({e1:[1,2,"ds","remainingCount"]},["",1])]),n.$text(0,[" "]),n.$if({e1:[6,function(a0) {return (a0 === 1);},2],e2:[1,2,"ds","remainingCount"]},1,[n.$text(0,[" item left "])],[n.$text(0,[" items left "])])]),n.elt("ul",0,{"id":"filters"},0,[n.$text(0,[" "]),n.cpt([_filterLink,"filterLink"],{e1:[1,1,"ds"],e2:[1,1,"ctl"]},{"ds":["",1],"ctl":["",2],"label":"All","filter":"all"},0),n.cpt([_filterLink,"filterLink"],{e1:[1,1,"ds"],e2:[1,1,"ctl"]},{"ds":["",1],"ctl":["",2],"label":"Active","filter":"active"},0),n.cpt([_filterLink,"filterLink"],{e1:[1,1,"ds"],e2:[1,1,"ctl"]},{"ds":["",1],"ctl":["",2],"label":"Completed","filter":"completed"},0)]),n.$if({e1:[1,2,"ds","doneCount"]},1,[n.elt("button",{e1:[3,2,"ctl","clearDoneTodos"]},{"id":"clear-completed"},{"click":1},[n.$text({e1:[1,2,"ds","doneCount"]},["Clear completed (",1,")"])])])])])]),n.elt("footer",0,{"id":"info"},0,[n.elt("p",0,0,0,[n.$text(0,["Double-click to edit a todo"])]),n.elt("p",0,0,0,[n.$text(0,["Credits: "]),n.elt("a",0,{"href":"https://github.com/b-laporte"},0,[n.$text(0,["Bertrand Laporte"])]),n.$text(0,[" - code derived from the "]),n.elt("a",0,{"href":"http://todomvc.com/architecture-examples/angularjs"},0,[n.$text(0,["angular JS Todo example"])])]),n.elt("p",0,0,0,[n.$text(0,["Should be soon part of "]),n.elt("a",0,{"href":"http://todomvc.com"},0,[n.$text(0,["TodoMVC"])])])])];
});



/**
 * template displaying the todo element
 * @param todo the todo data model
 * @param ctl the general controller
 */

var todoItem = require("hsp/rt").template(["todo","ds","ctl"], function(n){
  return [n.elt("li",{e1:[6,function(a0,a1) {return [((a0)? ''+"completed":''),((a1)? ''+"editing":'')].join(' ');},2,3],e2:[1,2,"todo","completed"],e3:[1,2,"todo","editMode"]},{"class":["",1]},0,[n.$text(0,[" "]),n.$if({e1:[1,2,"todo","editMode"]},1,[n.elt("form",{e1:[3,2,"ctl","doneEditing",1,2],e2:[1,1,"todo"]},0,{"submit":1},[n.elt("input",{e1:[1,3,"ds","editTodo","title"],e2:[1,3,"ds","editTodo","title"],e3:[3,2,"ctl","doneEditing",1,4],e4:[1,1,"todo"]},{"type":"text","class":"edit","title":["",1],"#model":["",2]},{"blur":3}),n.$text(0,[" "])])],[n.elt("div",0,{"class":"view"},0,[n.elt("input",{e1:[1,2,"todo","completed"],e2:[3,2,"ctl","syncData"]},{"class":"toggle","type":"checkbox","value":["",1]},{"change":2}),n.elt("label",{e1:[3,2,"ctl","editTodo",1,2],e2:[1,1,"todo"]},0,{"dblclick":1},[n.$text({e1:[1,2,"todo","title"]},["",1])]),n.elt("button",{e1:[3,2,"ctl","removeTodo",1,2],e2:[1,1,"todo"]},{"class":"destroy"},{"click":1})])])])];
});



/**
 * display a link to activate a filter on the todo list
 * @param ds the data set
 * @param ctl the general controller
 * @param {String} label the label to display in the link - e.g. "All"
 * @param {String} filter the corresponding filter code used in the data model - e.g. "all"
 */

var filterLink = require("hsp/rt").template(["ds","ctl","label","filter"], function(n){
  return [n.elt("li",0,0,0,[n.elt("a",{e1:[3,2,"ctl","selectFilter",1,2],e2:[1,1,"filter"],e3:[1,1,"label"],e4:[6,function(a0,a1) {return (((a0 === a1))? ''+"selected":'');},5,6],e5:[1,2,"ds","filter"],e6:[1,1,"filter"]},{"title":["",3],"class":["",4]},{"click":1},[n.$text({e1:[1,1,"label"]},["",1," "])])])];
});


